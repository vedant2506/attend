<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Attendance</title>
    <link rel="stylesheet" href="style.css">
      <!-- Add these two lines for PWA functionality -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1877f2">
</head>

<body>

    <div class="container">
        <!-- Home screen to choose role -->
        <div id="home-view" class="view active">
            <h1>QuickAttend</h1>
            <p>The fastest way to take attendance.</p>
            <button id="teacher-btn">I am a Teacher</button>
            <button id="student-btn">I am a Student</button>
        </div>

        <!-- Teacher's View -->
        <div id="teacher-view" class="view">
            <h2>Teacher Dashboard</h2>
            <p>Project this screen for students to scan.</p>
            <div id="qrcode-container">
                <div id="qrcode"></div>
                <p id="timer">New QR code in 15 seconds...</p>
            </div>
            <div id="alphanumeric-container" style="display: none;">
                <h2 id="alphanumeric-code"></h2>
                <p id="alphanumeric-timer"></p>
            </div>
            <button id="start-session-btn">Start Attendance Session</button>
            <button id="fallback-btn" style="display:none; background-color: #f59e0b;">Projector Broken?</button>
        </div>

        <!-- Student's View -->
        <div id="student-view" class="view">
            <h2>Student Scanner</h2>
            <div id="scanner-container">
                <video id="scanner-video"></video>
                <div class="scanner-overlay"></div>
            </div>

            <button id="scan-btn">Scan QR Code</button>
            <p>
                <a href="#" id="manual-entry-link">Projector not working? Enter code manually.</a>
            </p>
            <div id="manual-entry-container" style="display: none;">
                <input type="text" id="manual-code-input" placeholder="e.g., WOLF74LION">
                <button id="submit-code-btn">Submit Code</button>
            </div>
            <p id="scan-result"></p>
            <button class="back-btn">Go Back</button>


        </div>
    </div>

    <!-- QR Code Generation Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <!-- QR Code Scanning Library -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>

    <script src="script.js"></script>

  <!-- Add this script at the end to register the service worker -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').then(registration => {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, err => {
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>

</body>

</html>